<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Adam Sadowski">
<title>R Beginner’s Guide (Best Practices) - 2&nbsp; Start (Organized)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-learn-as-you-go.html" rel="next">
<link href="./01-record-each-step.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-start-organized.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Start (Organized)</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Beginner’s Guide (Best Practices)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/asadow/rbg/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-record-each-step.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Record (Each Step)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-start-organized.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Start (Organized)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-learn-as-you-go.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Learn (As You Go)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-stay-organized.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Review (to Stay Organized)</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-text-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prepare for Text Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whats-possible.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">What’s Possible</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#sec-name_files" id="toc-sec-name_files" class="nav-link active" data-scroll-target="#sec-name_files"><span class="header-section-number">2.1</span> Name Files</a></li>
  <li><a href="#bring-files-into-r" id="toc-bring-files-into-r" class="nav-link" data-scroll-target="#bring-files-into-r"><span class="header-section-number">2.2</span> Bring Files Into R</a></li>
  <li><a href="#bring-data-into-r" id="toc-bring-data-into-r" class="nav-link" data-scroll-target="#bring-data-into-r"><span class="header-section-number">2.3</span> Bring Data Into R</a></li>
  <li><a href="#check-data" id="toc-check-data" class="nav-link" data-scroll-target="#check-data"><span class="header-section-number">2.4</span> Check Data</a></li>
  <li><a href="#clean-data" id="toc-clean-data" class="nav-link" data-scroll-target="#clean-data"><span class="header-section-number">2.5</span> Clean Data</a></li>
  <li><a href="#check-with-your-team" id="toc-check-with-your-team" class="nav-link" data-scroll-target="#check-with-your-team"><span class="header-section-number">2.6</span> Check With Your Team</a></li>
  <li>
<a href="#remove-data" id="toc-remove-data" class="nav-link" data-scroll-target="#remove-data"><span class="header-section-number">2.7</span> Remove Data</a>
  <ul class="collapse">
<li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><code>filter()</code></a></li>
  <li><a href="#distinct" id="toc-distinct" class="nav-link" data-scroll-target="#distinct"><code>distinct()</code></a></li>
  </ul>
</li>
  <li>
<a href="#code-concisely" id="toc-code-concisely" class="nav-link" data-scroll-target="#code-concisely"><span class="header-section-number">2.8</span> Code Concisely</a>
  <ul class="collapse">
<li><a href="#and" id="toc-and" class="nav-link" data-scroll-target="#and"><code>|&gt;</code> and <code>%&gt;%</code></a></li>
  <li><a href="#summarize" id="toc-summarize" class="nav-link" data-scroll-target="#summarize"><code>summarize()</code></a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/asadow/rbg/edit/main/02-start-organized.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/asadow/rbg/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Start (Organized)</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="sec-name_files" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="sec-name_files">
<span class="header-section-number">2.1</span> Name Files</h2>
<p>Now that we have covered how to write lines, we can start writing lines about the data, right? Not yet. Let’s make sure our files have the best names possible as that will help in later writing about the data.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>File naming is useful even if you only have one file of data. Apart from its clarity, it prepares you for the future possibility of having multiples files of data. Data sent to an analyst is often updated and re-sent, at which time you may want to keep records of the old and new.</p>
</div>
</div>
</div>
<p><strong>Definitions:</strong></p>
<ol type="1">
<li>
<code>_</code> is called underscore.</li>
<li>
<code>-</code> is called dash.</li>
</ol>
<p>Use <code>_</code> as a separator, that is, to separate different characteristics of the file. Use <code>-</code> to separate parts within characteristics. For example,</p>
<pre><code>lesson-1_on-qmd_2022-02-18.qmd</code></pre>
<p>If you have related files that you want to systematically process, then be systematic with the order of characteristics. For example,</p>
<pre><code>lesson-1_on-qmd_2022-02-18.qmd
lesson-2_on-qmd_2022-02-19.qmd
lesson-3_on-qmd_2022-02-20.qmd
lesson-1_on-python_2022-02-20.qmd</code></pre>
<p>Consider how these files will look when ordered alphabetically in your operating system’s file manager (File Explorer on Window’s or Finder on Mac) if that is important to you. The above files will be ordered like so:</p>
<pre><code>lesson-1_on-qmd_2022-02-18.qmd
lesson-1_on-ruby_2022-02-20.qmd
lesson-2_on-qmd_2022-02-19.qmd
lesson-3_on-qmd_2022-02-20.qmd</code></pre>
<p>If the order of characteristics start with the most general, then the alphabetic ordering will be more appropriate:</p>
<pre><code>on-qmd_lesson-1_2022-02-18.qmd
on-qmd_lesson-2_2022-02-19.qmd
on-qmd_lesson-3_2022-02-20.qmd
on-ruby_lesson-1_2022-02-20.qmd</code></pre>
<p>Consistency helps you visually process the files you see on your file explorer. It also helps when telling your computer how to process the files. We named the files using separators so that numeric information can be represented. That is, the phrase before the first <code>_</code> is the first characteristic, the phrase before the second <code>_</code> is the second characteristic and so on.</p>
<p>To process the file names in a way that splits these characteristics, we can use a function <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code> from an R package called <code>stringr</code>. File names are strings. Strings are character elements that cannot directly be treated numerically (they need to be converted into numeric elements first for that).</p>
<p>To use a function from a package, we first install the package by running</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"stringr"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Delete this line once you are done, as you will have no need to rerun (re-process) it.</p>
<p>We use a colon (the symbol <code>:</code>) twice to use a function from a package. If you write</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>stringr<span class="sc">::</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>you will see a drop-down menu of all the functions from stringr. <code>str</code> stands for string. Many function names start with <code>str_</code>. The drop-down menu from writing <code>stringr::</code> adjusts when you add <code>str_</code>. For every function whose name starts with <code>str_</code>, the general purpose is the processing of strings. Similar to our file names above, the general part of the name comes first, then the <code>_</code>, and then the more specific purpose.</p>
<p>There are a few exceptions; some functions in stringr do not start with <code>str_</code>. But most start with <code>str_</code> because <code>str_</code> makes it clear what the function will process. This is important as we can avoid the need to write out <code>stringr::</code>. We avoid this by loading the package: making the function names in the package available. To load the package, run the following</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now when we only write <code>str_</code>, we still get a drop-down menu. To use a <code>str_</code> function, we need some input strings.</p>
</section><section id="bring-files-into-r" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="bring-files-into-r">
<span class="header-section-number">2.2</span> Bring Files Into R</h2>
<p>Let’s get our consistent file names into R. We will use a function called <code><a href="https://rdrr.io/r/base/file.choose.html">file.choose()</a></code>.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>When referring to a function, <code>()</code> makes it crystal clear that the object has arguments, or in other words, inputs. <code>()</code> means either</p>
<ol type="1">
<li>the function is used with its default arguments, or</li>
<li>the function is just being referred to in text, as above.</li>
</ol>
</div>
</div>
</div>
<p><code><a href="https://rdrr.io/r/base/file.choose.html">file.choose()</a></code> causes a pop-up that allows you to interactively search your computer files. If you are using Windows, this pop-up may unfortunately pop-up behind RStudio. You will need to Alt-Tab to find the pop-up. Once you see the pop-up, find the folder with your files and double click on (any) one of the files. The function will print the file path (the computer’s representation of where the file exists). Below we assign the file path to the object <code>file_path</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html">file.choose</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now use a function <code><a href="https://fs.r-lib.org/reference/path_file.html">path_dir()</a></code> from the package fs. <code><a href="https://fs.r-lib.org/reference/path_file.html">path_dir()</a></code> will get the path of the directory from the file path. We will assign the result to the object <code>directory_path</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org">fs</a></span><span class="op">)</span></span>
<span><span class="va">directory_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://fs.r-lib.org/reference/path_file.html">path_dir</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get a list of .csv files in this directory, we will use a <code><a href="https://rdrr.io/r/base/list.files.html">list.files()</a></code> function. This function has what are called two arguments. The first is the path to the folder that contains our files. The second is the pattern that is unique to the files we want.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="va">directory_path</span>, pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span><span class="va">files</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gapminder_afganistan_2022-02-21.csv" 
[2] "gapminder_afghanistan_2022-02-21.csv"
[3] "gapminder_canada_2022-02-21.csv"     </code></pre>
</div>
</div>
<p>Now we use <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code> which will split our strings. For example,</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">files</span>, <span class="st">"_"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "gapminder"      "afganistan"     "2022-02-21.csv"

[[2]]
[1] "gapminder"      "afghanistan"    "2022-02-21.csv"

[[3]]
[1] "gapminder"      "canada"         "2022-02-21.csv"</code></pre>
</div>
</div>
<p>This result is what is called a list. A list can contain anything. The [[1]] and [[2]] represent the first and second element of the list. The [1] indicates that the element to its very right is the first element.</p>
<p>To also separate the file type (.qmd) at the end, preceded by the period, we can adjust our function to separate by <code>_</code> as well as <code>.</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">files</span>, <span class="st">"_."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "gapminder"     "fganistan"     "022-02-21.csv"

[[2]]
[1] "gapminder"     "fghanistan"    "022-02-21.csv"

[[3]]
[1] "gapminder"     "anada"         "022-02-21.csv"</code></pre>
</div>
</div>
<p>What happened? This is not what we want, and it is because <code>.</code> is a special (i.e.&nbsp;meta) character. Special characters mean more to R than the literal symbol itself. The special character <code>.</code> represents any character. Hence we told <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code> to use <code>_.</code> as a separator which meant that <code>_A</code> was used as the first separator, and <code>_2</code> as the second separator. We need to use different special characters to overcome this challenge: <code>[</code> and <code>]</code>. These square brackets can be used to surround the distinct characters that <code>str_split</code> will use as separators: <code>[_.]</code> will tell <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code> to use either a <code>_</code> or a literal <code>.</code> as the separator.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">files</span>, <span class="st">"[_.]"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "gapminder"  "afganistan" "2022-02-21" "csv"       

[[2]]
[1] "gapminder"   "afghanistan" "2022-02-21"  "csv"        

[[3]]
[1] "gapminder"  "canada"     "2022-02-21" "csv"       </code></pre>
</div>
</div>
<p>We can have a cleaner result using <code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed()</a></code>. It is called “fixed” as we can fix the number of splits or pieces. We will split our strings into 4 pieces.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">files</span>, <span class="st">"[_.]"</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]        [,2]          [,3]         [,4] 
[1,] "gapminder" "afganistan"  "2022-02-21" "csv"
[2,] "gapminder" "afghanistan" "2022-02-21" "csv"
[3,] "gapminder" "canada"      "2022-02-21" "csv"</code></pre>
</div>
</div>
<p>This result is what is called a matrix. Let’s assign it to the object m.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split_fixed</a></span><span class="op">(</span><span class="va">files</span>, <span class="st">"[_.]"</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can see the matrix just by processing</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]        [,2]          [,3]         [,4] 
[1,] "gapminder" "afganistan"  "2022-02-21" "csv"
[2,] "gapminder" "afghanistan" "2022-02-21" "csv"
[3,] "gapminder" "canada"      "2022-02-21" "csv"</code></pre>
</div>
</div>
<p>Let’s add informative names to the columns of the matrix. To do this, we use a function called <code><a href="https://rdrr.io/r/base/colnames.html">colnames()</a></code>. This function will be placed on the left of <code>&lt;-</code> as it is a replacement function. We replace the null (i.e.&nbsp;undefined) column names of our matrix with our list of characteristics.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>, <span class="st">"country"</span>, <span class="st">"date"</span>, <span class="st">"file_type"</span><span class="op">)</span></span>
<span><span class="va">m</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     source      country       date         file_type
[1,] "gapminder" "afganistan"  "2022-02-21" "csv"    
[2,] "gapminder" "afghanistan" "2022-02-21" "csv"    
[3,] "gapminder" "canada"      "2022-02-21" "csv"    </code></pre>
</div>
</div>
<p>Let’s create an object named df with a function called <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble()</a></code> from the package <code>tibble</code>. What is a tibble? It is an R word for table. Remember to install tibble before running</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  source    country     date       file_type
  &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    
1 gapminder afganistan  2022-02-21 csv      
2 gapminder afghanistan 2022-02-21 csv      
3 gapminder canada      2022-02-21 csv      </code></pre>
</div>
</div>
<!-- Let's add a column called `file_path` that is a combination of our directory path, a forward slash (the symbol `\`), and the original strings (the object `files`). We create this combination using a function called `glue` from the package `glue`. Inside `glue`'s quotation marks, objects can be referenced when placed inside curly brackets like so `{object_name}`. -->
<!-- ```{r glue} -->
<!-- library(glue) -->
<!-- file_paths <- glue("{directory_path}/{files}") -->
<!-- file_paths -->
<!-- ``` -->
<p>We now need the file path for each of our files. To list the files in our directory, use the function <code><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls()</a></code>. Assign the result to object <code>file_paths</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="va">directory_path</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now change our tibble so that there is a new column called <code>file_path</code> that contains our <code>file_paths</code>. To do this, we will use a function from the package <code>dplyr</code> (pronounced “data plier”). The function we will use is named after another word for change: <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. This function has two arguments. The first is the tibble. The second is the name of the new column, an equal sign, and the values we want in that column.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">df</span>, file_path <span class="op">=</span> <span class="va">file_paths</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bring-data-into-r" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="bring-data-into-r">
<span class="header-section-number">2.3</span> Bring Data Into R</h2>
<p>We can read in the data related to each file with the help of the <code>file_path</code> column. Not only that, we can read in the data so that it is organized inside our tibble. In each row of our tibble, we will add each file’s data hidden in a little box or “nest”. These nests will go under a column called <code>data</code>.</p>
<p>To change our tibble so that there is a new column, we will again use <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. The first argument is the tibble, just like above. The second is the name of the new column (<code>data</code>), an equal sign, and the values we want in that column.</p>
<p>Since the values in this column will be data sets, we need to put these data sets in containers. Where we see <code>"csv"</code> 3 times under <code>file_type</code> in our tibble, we will see <code>"&lt;S3: spec_tbl_df&gt;"</code> 3 times under <code>data</code>. The <code>&lt;</code> and <code>&gt;</code> mean container. The <code>S3: spec_tbl_df</code> means data frame (another word for data set).</p>
<p>We need to use a special function inside <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> when creating our <code>data</code> column so that the values of the <code>data</code> column are containers. This special function is called <code>map()</code> from the package <code>purrr</code>. <code>purrr</code> is pronounced like a cat’s purr (the low vibrating sound of happiness) and it refers to purposeful programming with R.</p>
<p>The result of <code>map()</code> will always be containers. The number of containers will always be the same as the length of the first argument to <code>map()</code>. The second argument of <code>map()</code> is the function that will be applied to the first argument. To create the <code>data</code> column, the first argument will be the <code>file_path</code>, and the second argument will be a custom read function.</p>
<p>The read function below, <code>read_csv_c()</code>, uses a function called <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> from the package <code>readr</code>. <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> reads .csv files and determines what kind of columns are in the data (e.g.&nbsp;numeric or character). We will decide the kind of columns ourselves, so we need to prevent the function from doing so. <code>col_types</code> is the argument inside of <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> with a <code>.default</code>. We need to set the <code>.default</code> to be <code>"c"</code>. <code>"c"</code> stands for character. Character is a safe default as it is the original format of the .csv data.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">read_csv_c</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">csv_file_path</span><span class="op">)</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">csv_file_path</span>, col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we use our new function to read in our data.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">df</span>, data <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">file_path</span>, <span class="va">read_csv_c</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  source    country     date       file_type file_path                data      
  &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;     &lt;fs::path&gt;               &lt;named li&gt;
1 gapminder afganistan  2022-02-21 csv       …ganistan_2022-02-21.csv &lt;spc_tbl_&gt;
2 gapminder afghanistan 2022-02-21 csv       …hanistan_2022-02-21.csv &lt;spc_tbl_&gt;
3 gapminder canada      2022-02-21 csv       …r_canada_2022-02-21.csv &lt;spc_tbl_&gt;</code></pre>
</div>
</div>
<p>We no longer need the <code>file_path</code> column so we will select it to be removed by using the <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">df</span>, <span class="op">-</span> <span class="va">file_path</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can open our containers or “nests” in <code>data</code> using the function <code><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest()</a></code> from the package <code>tidyr</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 9
   source    country     date  file_type continent year  lifeExp pop   gdpPercap
   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    
 1 gapminder afghanistan 2022… csv       Asia      1952  28.801  8425… 779.4453…
 2 gapminder afghanistan 2022… csv       Asia      1957  30.332  9240… 820.8530…
 3 gapminder afghanistan 2022… csv       Asia      1962  31.997  1026… 853.10071
 4 gapminder afghanistan 2022… csv       Asia      1967  34.02   1153… 836.1971…
 5 gapminder afghanistan 2022… csv       Asia      1972  36.088  1307… 739.9811…
 6 gapminder afghanistan 2022… csv       Asia      1977  38.438  1488… 786.11336
 7 gapminder afghanistan 2022… csv       Asia      1982  39.854  1288… 978.0114…
 8 gapminder afghanistan 2022… csv       Asia      1987  40.822  1386… 852.3959…
 9 gapminder afghanistan 2022… csv       Asia      1992  41.674  1631… 649.3413…
10 gapminder afghanistan 2022… csv       Asia      1997  41.763  2222… 635.3413…
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>This data looks clean but looks can be deceiving. Remember that we set the <code>df</code> object to be a tibble with <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble()</a></code>? A tibble is not only a table in R, but a cleaner kind of table. It shows only 10 rows, and as many columns that can comfortably be displayed. The sizing of the table surrounds the data, like the header (top line) <code># A tibble: 24 x 9</code> tells you how many rows (24) and columns (9) there are. The footer (bottom line) tells you what is missing from the display.</p>
<p>Even though this data is small (24 rows by 9 columns can be evaluated using our eyes), it is always best to practice techniques that are generalizable to both small and large data. Let’s check the data with code.</p>
</section><section id="check-data" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="check-data">
<span class="header-section-number">2.4</span> Check Data</h2>
<p>The simplest way to start evaluating data is to check that the values under each column meet expectations. Since we created the first 4 columns using our file names, we can be sure that these 4 columns are clean. For the next column, <code>continent</code>, we expect values to be continents, capitalized, and spelled correctly. Instead of reading each line with our eyes, we can read each line with our computers. Or a combination of the two. That is exactly how we will start.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">continent</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Asia"     "Americas"</code></pre>
</div>
</div>
<p>These unique values are perfect. Which means every value is perfect, as these unique values represent them. But what if they were not capitalized, for example? That is in fact the case with our country column: the values are not capitalized because the values came from our file-naming, and it is good practice not to capitalize when file-naming.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">country</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "afghanistan" "canada"     </code></pre>
</div>
</div>
</section><section id="clean-data" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="clean-data">
<span class="header-section-number">2.5</span> Clean Data</h2>
<p>To capitalize the values in a column, you can use a function called <code><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">df</span>, country <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_title</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 9
   source    country     date  file_type continent year  lifeExp pop   gdpPercap
   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    
 1 gapminder Afghanistan 2022… csv       Asia      1952  28.801  8425… 779.4453…
 2 gapminder Afghanistan 2022… csv       Asia      1957  30.332  9240… 820.8530…
 3 gapminder Afghanistan 2022… csv       Asia      1962  31.997  1026… 853.10071
 4 gapminder Afghanistan 2022… csv       Asia      1967  34.02   1153… 836.1971…
 5 gapminder Afghanistan 2022… csv       Asia      1972  36.088  1307… 739.9811…
 6 gapminder Afghanistan 2022… csv       Asia      1977  38.438  1488… 786.11336
 7 gapminder Afghanistan 2022… csv       Asia      1982  39.854  1288… 978.0114…
 8 gapminder Afghanistan 2022… csv       Asia      1987  40.822  1386… 852.3959…
 9 gapminder Afghanistan 2022… csv       Asia      1992  41.674  1631… 649.3413…
10 gapminder Afghanistan 2022… csv       Asia      1997  41.763  2222… 635.3413…
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>It would be quite the task for this book to cover every method of checking and cleaning data. We covered the best-case scenario: the country column above was systematically unclean. Next, we show the worst-case scenario: manually entered text data. Later we show how to discover data validating and cleaning methods in <span class="quarto-unresolved-ref">?sec-learn-as-you-go</span>.</p>
<p>The next section is only for demonstrative purposes. Please see <span class="quarto-unresolved-ref">?sec-text-data</span> to prepare for actual text data methods.</p>
</section><section id="check-with-your-team" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="check-with-your-team">
<span class="header-section-number">2.6</span> Check With Your Team</h2>
<p>Suppose people answered a survey that included questions on how much time their children spend doing X on a typical day. These questions have two text boxes:</p>
<p>Unique responses to the first box of the first question:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"5"</span>, <span class="cn">NA</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"2"</span>, <span class="st">""</span>,  <span class="st">"1"</span>, <span class="st">"6"</span>, <span class="st">"8"</span>, <span class="st">"60"</span>,  <span class="st">"30"</span>,  <span class="st">"45"</span>,  <span class="st">"7"</span>, <span class="st">"20"</span>, <span class="st">"9"</span>, <span class="st">"35"</span>,  <span class="st">"3 "</span>,  <span class="st">"1.5"</span>, <span class="st">"4-5"</span>, <span class="st">"2 "</span>,  <span class="st">"40"</span>, <span class="st">"Day care"</span>, <span class="st">"3 to 4"</span>, <span class="st">"10"</span>,  <span class="st">"48"</span>,  <span class="st">"4hrs"</span>,  <span class="st">"15"</span>,  <span class="st">"90"</span>, <span class="st">"?"</span>, <span class="st">"12"</span><span class="op">)</span></span>
<span><span class="va">n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "5"        NA         "3"        "4"        "2"        ""        
 [7] "1"        "6"        "8"        "60"       "30"       "45"      
[13] "7"        "20"       "9"        "35"       "3 "       "1.5"     
[19] "4-5"      "2 "       "40"       "Day care" "3 to 4"   "10"      
[25] "48"       "4hrs"     "15"       "90"       "?"        "12"      </code></pre>
</div>
</div>
<p>Unique responses to the second box which allows selection of the units:</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Minutes"</span>, <span class="st">"Hours"</span><span class="op">)</span></span>
<span><span class="va">units</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Minutes" "Hours"  </code></pre>
</div>
</div>
<p>Evidently this data needs to be cleaned before we do <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric()</a></code> which turns non-numeric strings into <code>NA</code>.</p>
<p>First, we might think, let’s deal with the interval responses like <code>4-5</code>. We note there’s also a response <code>3 to 4</code>. We can turn these responses into proper numbers like so:</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Don't worry about understanding the code here</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">n</span>, <span class="st">"^(.*?)(-|to).*"</span>, <span class="st">"\\1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">n</span>, <span class="st">"^.*(-|to)(.*?)"</span>, <span class="st">"\\2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">n</span>, <span class="st">"-|to"</span><span class="op">)</span>, <span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">n</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "5"        NA         "3"        "4"        "2"        ""        
 [7] "1"        "6"        "8"        "60"       "30"       "45"      
[13] "7"        "20"       "9"        "35"       "3 "       "1.5"     
[19] "4.5"      "2 "       "40"       "Day care" "3.5"      "10"      
[25] "48"       "4hrs"     "15"       "90"       "?"        "12"      </code></pre>
</div>
</div>
<p>Next we might think, let’s turn <code>4hrs</code> into <code>4</code>. But wouldn’t you want to know first that the units aren’t missing from the second box? And what’s <code>Day care</code> about? Does that mean “duration of day care”?</p>
<p>Before we start cleaning this data, converting units using the unit selected and slapping a pretty name like <code>avg_day_play_time_hrs</code>… human error needs to be considered. What if someone selected the wrong units? What sort of limits should we impose on plausible responses: e.g.&nbsp;is 16 hours the upper limit of a child’s active play time? After conversion to hours, do we then screen for <code>&gt; 16</code> and turn those responses into minutes?</p>
<p>These are some of the questions one can ask before deciding to commit fully to cleaning this data. Holding off on cleaning to communicate with your team might be best practice. It may turn out that better methods of collecting data are enforced.</p>
</section><section id="remove-data" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="remove-data">
<span class="header-section-number">2.7</span> Remove Data</h2>
<section id="filter" class="level3"><h3 class="anchored" data-anchor-id="filter"><code>filter()</code></h3>
<p>If we decide, after cleaning, that we don’t need parts of the data, should we remove files or edit the raw data? It’s often a better idea to keep a record of changes, with both code and comments. For example, to remove all but data on Asia, we can use <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Analysis is only on Asia</span></span>
<span><span class="va">df_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">continent</span> <span class="op">==</span> <span class="st">"Asia"</span><span class="op">)</span></span>
<span><span class="va">df_filtered</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 9
   source    country     date  file_type continent year  lifeExp pop   gdpPercap
   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    
 1 gapminder Afghanistan 2022… csv       Asia      1952  28.801  8425… 779.4453…
 2 gapminder Afghanistan 2022… csv       Asia      1957  30.332  9240… 820.8530…
 3 gapminder Afghanistan 2022… csv       Asia      1962  31.997  1026… 853.10071
 4 gapminder Afghanistan 2022… csv       Asia      1967  34.02   1153… 836.1971…
 5 gapminder Afghanistan 2022… csv       Asia      1972  36.088  1307… 739.9811…
 6 gapminder Afghanistan 2022… csv       Asia      1977  38.438  1488… 786.11336
 7 gapminder Afghanistan 2022… csv       Asia      1982  39.854  1288… 978.0114…
 8 gapminder Afghanistan 2022… csv       Asia      1987  40.822  1386… 852.3959…
 9 gapminder Afghanistan 2022… csv       Asia      1992  41.674  1631… 649.3413…
10 gapminder Afghanistan 2022… csv       Asia      1997  41.763  2222… 635.3413…
11 gapminder Afghanistan 2022… csv       Asia      2002  42.129  2526… 726.7340…
12 gapminder Afghanistan 2022… csv       Asia      2007  43.828  3188… 974.5803…</code></pre>
</div>
</div>
</section><section id="distinct" class="level3"><h3 class="anchored" data-anchor-id="distinct"><code>distinct()</code></h3>
<p>We can keep only unique (i.e.&nbsp;distinct) values under the a column using <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code>. It produces a tibble with only the distinct rows for the column(s) you choose. The argument <code>.keep_all</code>, if set to <code>TRUE</code>, keeps all columns. This can be seen in the help page: <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">?distinct</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">country</span>, <span class="va">continent</span><span class="op">)</span>, <span class="va">continent</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  country     continent
  &lt;chr&gt;       &lt;chr&gt;    
1 Afghanistan Asia     
2 Canada      Americas </code></pre>
</div>
</div>
</section></section><section id="code-concisely" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="code-concisely">
<span class="header-section-number">2.8</span> Code Concisely</h2>
<p>We can write the above in a more readable way using a special symbol.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">continent</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  country     continent
  &lt;chr&gt;       &lt;chr&gt;    
1 Afghanistan Asia     
2 Canada      Americas </code></pre>
</div>
</div>
<p>How did that work?</p>
<section id="and" class="level3"><h3 class="anchored" data-anchor-id="and">
<code>|&gt;</code> and <code>%&gt;%</code>
</h3>
<p><code>|&gt;</code> and <code>%&gt;%</code> are called pipes and are used like so: <code>left_side |&gt; right_side()</code>. They send the left side to the right side. The <code>|&gt;</code> is newer and recommended because, where as the left side is an input, the right side is a function, and <code>|&gt;</code> enforces the <code>()</code> after the function name. Since <code>|&gt;</code> enforces an explicit and safer style, let’s stick with it.</p>
<p>The other property to remember is that the pipe holds mathematical priority before brackets and exponents. So if you know BEDMASS, then you also know BE<code>|&gt;</code>DMASS.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.236068</code></pre>
</div>
</div>
<p>is the same as</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">5</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.236068</code></pre>
</div>
</div>
<p>But</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">5</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.18034</code></pre>
</div>
</div>
<p>is not the same as</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>For a more relevant example,</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">df</span>, year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>is the same as</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which is the same as</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">year</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>|&gt;</code> is most useful to group together steps that accomplish a goal, e.g., summarizing data.</p>
</section><section id="summarize" class="level3"><h3 class="anchored" data-anchor-id="summarize"><code>summarize()</code></h3>
<p>A few more functions allow for concise writing. <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> is used to calculate a summary statistic.</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Find the max year per country</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>max_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">country</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  country     max_year
  &lt;chr&gt;          &lt;dbl&gt;
1 Afghanistan     2007
2 Canada          2007</code></pre>
</div>
</div>
<p>It’s a short form for a number of other functions:</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Find the max year per country</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>max_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">max_year</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   country [2]
  country     max_year
  &lt;chr&gt;          &lt;dbl&gt;
1 Afghanistan     2007
2 Canada          2007</code></pre>
</div>
</div>
<p>We have not covered <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> but we can see how it groups the data for the function(s) that follow it. Notice how the above data has a group.</p>
<section id="count" class="level4"><h4 class="anchored" data-anchor-id="count"><code>count()</code></h4>
<p>The last short form we will cover is <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code>. Instead of</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .by <span class="op">=</span> <span class="va">country</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  country         n
  &lt;chr&gt;       &lt;int&gt;
1 Afghanistan    12
2 Canada         12</code></pre>
</div>
</div>
<p>you can write</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  country         n
  &lt;chr&gt;       &lt;int&gt;
1 Afghanistan    12
2 Canada         12</code></pre>
</div>
</div>


</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./01-record-each-step.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Record (Each Step)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-learn-as-you-go.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Learn (As You Go)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">R Beginner’s Guide was written by Adam Sadowski.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>