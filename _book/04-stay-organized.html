<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Adam Sadowski">
<title>R Beginner’s Guide (Best Practices) - 4&nbsp; Review (to Stay Organized)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-text-data.html" rel="next">
<link href="./03-learn-as-you-go.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-stay-organized.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Review (to Stay Organized)</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R Beginner’s Guide (Best Practices)</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/asadow/rbg/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-record-each-step.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Record (Each Step)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-start-organized.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Start (Organized)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-learn-as-you-go.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Learn (As You Go)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-stay-organized.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Review (to Stay Organized)</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-text-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prepare for Text Data</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#optimal-file-folder-structure-explicit" id="toc-optimal-file-folder-structure-explicit" class="nav-link active" data-scroll-target="#optimal-file-folder-structure-explicit"><span class="header-section-number">4.1</span> Optimal File-Folder Structure (Explicit)</a></li>
  <li>
<a href="#optimal-reports-fast-renderability" id="toc-optimal-reports-fast-renderability" class="nav-link" data-scroll-target="#optimal-reports-fast-renderability"><span class="header-section-number">4.2</span> Optimal Reports (Fast Renderability)</a>
  <ul class="collapse">
<li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#method" id="toc-method" class="nav-link" data-scroll-target="#method">Method</a></li>
  </ul>
</li>
  <li><a href="#optimal-data-access-reliable" id="toc-optimal-data-access-reliable" class="nav-link" data-scroll-target="#optimal-data-access-reliable"><span class="header-section-number">4.3</span> Optimal Data Access (Reliable)</a></li>
  <li>
<a href="#optimal-code-maintanable" id="toc-optimal-code-maintanable" class="nav-link" data-scroll-target="#optimal-code-maintanable"><span class="header-section-number">4.4</span> Optimal Code (Maintanable)</a>
  <ul class="collapse">
<li><a href="#making-your-own-functions" id="toc-making-your-own-functions" class="nav-link" data-scroll-target="#making-your-own-functions">Making Your Own Functions</a></li>
  <li><a href="#adding-function-checks" id="toc-adding-function-checks" class="nav-link" data-scroll-target="#adding-function-checks">Adding Function Checks</a></li>
  <li><a href="#comparing-your-functions-to-others" id="toc-comparing-your-functions-to-others" class="nav-link" data-scroll-target="#comparing-your-functions-to-others">Comparing Your Functions to Others</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/asadow/rbg/edit/main/04-stay-organized.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/asadow/rbg/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Review (to Stay Organized)</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Staying organized means keeping project complexity in check as it expands. Each of these checks below help to avoid unnecessary and common frustrations. They address how to optimize the organization of your files, the speed and focus of your reports, the reliability of data access, and code readability.</p>
<section id="optimal-file-folder-structure-explicit" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="optimal-file-folder-structure-explicit">
<span class="header-section-number">4.1</span> Optimal File-Folder Structure (Explicit)</h2>
<p>We discussed how to optimally name data files in <a href="02-start-organized.html#sec-name_files"><span>Section&nbsp;2.1</span></a>. We discussed how to write a Quarto report (a <code>.qmd</code> file) in <a href="01-record-each-step.html"><span>Chapter&nbsp;1</span></a>. Should these sit in the same folder? For a small project, that can be adequate. However, it’s best to organize different kinds of files into different folders. This will help prevent confusion if and when our projects become large. It can also dramatically speed up the rendering of our reports, which is covered in the next section.</p>
<p>Generally, project files should be organized into the below folders:</p>
<ul>
<li>
<code>data-raw</code> (raw data files)</li>
<li>
<code>data</code> (<code>.R</code> files that process raw data and create clean subsets)</li>
<li>
<code>R_analysis</code> (<code>.R</code> files that create analytic results)</li>
</ul>
<p>If reporting, you should also have the following:</p>
<ul>
<li>
<code>output</code> (outputs that will be shared or used in reports; the latter can be the final objects in R_analysis saved as <code>.rds</code>)</li>
<li>
<code>qmd</code> (<code>.qmd</code> files which are Quarto reports)</li>
<li>
<code>Rmd</code> (<code>.Rmd</code> files which are RMarkdown reports)</li>
</ul>
<p>Optionally:</p>
<ul>
<li>
<code>prose</code> (references like Word documents, text files, etc.)</li>
</ul></section><section id="optimal-reports-fast-renderability" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="optimal-reports-fast-renderability">
<span class="header-section-number">4.2</span> Optimal Reports (Fast Renderability)</h2>
<section id="motivation" class="level3"><h3 class="anchored" data-anchor-id="motivation">Motivation</h3>
<p>In <a href="01-record-each-step.html"><span>Chapter&nbsp;1</span></a> we processed raw data in a Quarto document, which would go inside the <code>qmd</code> folder. Above we are saying that raw data should be processed in <code>.R</code> files inside of the <code>data</code> folder. Why the change?</p>
<p>To be fair, many analysts start their R journey using Quarto (or RMarkdown), including me. For Python users likewise, they often start with Jupyter. The ability to combine prose (written text), code, and outputs is beginner-friendly. It’s not, however, always computer-friendly. If code that processes data takes a moderate time to run, the report render will take at least the same amount of time. If, instead, the code takes a short amount of time to run, because it does not process data beyond simply importing it, then the report render will be much, much faster.</p>
</section><section id="method" class="level3"><h3 class="anchored" data-anchor-id="method">Method</h3>
<p>If we want fast reports, we want to simply import data and plots. We take out the data processing parts of our <code>.qmd</code> file and place them into an <code>.R</code> file (or multiple <code>.R</code> files) inside a new <code>analysis</code> folder. We name these <code>.R</code> files with the same philosophy as in <a href="02-start-organized.html#sec-name_files"><span>Section&nbsp;2.1</span></a>: phrases separated by <code>_</code>, words in phrases separated by <code>-</code>. With several <code>.R</code> files, we add 0-padded numbers to the front of the file name. Here is an example:</p>
<ul>
<li><code>01_merge-data.R</code></li>
<li><code>02_filter-data.R</code></li>
<li><code>03_plot-data.R</code></li>
<li><code>04_stat-analysis.R</code></li>
</ul>
<p>Any objects that we need for our report are saved using <code><a href="https://readr.tidyverse.org/reference/read_rds.html">readr::write_rds()</a></code>. The first two arguments are the object to write, and the file path (where to write it). The object can, for example, be a data file we want to display as a table in our report. The file path is going to refer to the new <code>output</code> folder. The best way to refer to files in this folder is to use the <code>here</code> package. <code><a href="https://here.r-lib.org//reference/here.html">here::here()</a></code> is the function, and its name comes from the idea: “Here, I’m in this project, so let’s start at the file path to our project folder, i.e.&nbsp;the root folder.” Knowing this, <code><a href="https://here.r-lib.org//reference/here.html">here::here()</a></code> simply takes strings that point to the location of any of our project’s files. For example, <code>here::here("output", "data_for_table.rds")</code> will create a file path to the <code>output</code> folder ending with <code>data_for_table.rds</code>.</p>
<p>For example, we have a data file we want to display as a table, it will be saved somewhere in the above files with a line like <code>write_rds(data_for_table, here("output", "data_for_table.rds"))</code>.</p>
<p>Then, in our <code>.qmd</code> file, we can simply add <code>data_for_table &lt;- read_rds(here("output", "data_for_table.rds"))</code>. Either load the <code>readr</code> library or prepend <code>read_rds()</code> with <code>readr::</code>.</p>
<p>Finally, place the <code>.qmd</code> file into the <code>qmd</code> folder. Now we not only have a faster report, but our project is more organized.</p>
</section></section><section id="optimal-data-access-reliable" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="optimal-data-access-reliable">
<span class="header-section-number">4.3</span> Optimal Data Access (Reliable)</h2>
<p>It’s a great idea to review how your getting raw data. If they are emailed .csv or .xlsx files, and especially if they have been manually edited or downloaded, there might be a better way to access data from the source. Accessing raw data from the source is more reliable and automatic. There’s less chance of a middle person between you and the data making a mistake and you having to re-run scripts with the corrections if the mistake even gets discovered! Also, you can get data without the limitations that come from waiting for a person to manage and deliver it.</p>
<p>Reviewing your strategy and improving it to allow for direct access may take more up-front work, but it usually will reduce future work. Another benefit is that learning to directly access data will up-skill you and further your career. You can learn software (data) engineering concepts like databases, API’s (Application Programming Interfaces), and more. These topics are beyond the scope of this book, but this section is here to encourage you to ask questions and learn more. A good book or large-language model can help introduce you to these topics. Once you become familiar with the lingo, you can start to incorporate database concepts with the following packages:</p>
<ul>
<li>
<code>dbplyr</code> for lazy loading and computation (i.e.&nbsp;using the database server instead of your computer to hold data in memory and perform work)</li>
<li>
<code>DBI</code> for reading and writing to databases</li>
<li>
<code>dm</code> for data models (tables in your database and their relationships to each other)</li>
<li>
<code>httr2</code> for data to and from API’s</li>
</ul></section><section id="optimal-code-maintanable" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="optimal-code-maintanable">
<span class="header-section-number">4.4</span> Optimal Code (Maintanable)</h2>
<p>If you find yourself copy and pasting code, then it is time to use a function. In R, writing functions is simpler than in other languages. Functions do not require type-checking since R is not a type-checked language. We will go over types at the very end of the section.</p>
<section id="making-your-own-functions" class="level3"><h3 class="anchored" data-anchor-id="making-your-own-functions">Making Your Own Functions</h3>
<p>If, for example, you need to read another set of data with a similar naming structure to <a href="02-start-organized.html#sec-name_files"><span>Section&nbsp;2.1</span></a>, then a function will communicate your code more clearly. To recap, the code below imported and cleaned our multiple data files into a signle data frame:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">file_names</span> <span class="op">&lt;-</span> <span class="va">directory_path</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="va">directory_path</span> <span class="op">|&gt;</span> <span class="fu">dir_ls</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_matrix</span> <span class="op">&lt;-</span> <span class="va">file_names</span> <span class="op">|&gt;</span> <span class="fu">str_split_fixed</span><span class="op">(</span><span class="st">"[._]"</span>, <span class="va">n_phrases</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">split_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">names_phrases</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">split_matrix</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">file_paths</span>, <span class="va">read_csv</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For starters, a function is created by assigning <code>function()</code> to an object, and entering the inputs inside the <code>()</code>. The inputs of a function should be the parts of the function that change over repeated use.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>What part of our code is not repetitive now that we want to repeat the task for a set of different files?</p>
<p>For one, we can imagine that we are pointing to a different folder (<code>directory_path</code>). So the first input can be <code>file_path</code> (a folder itself is a file). A new set of files might have a different number of phrases in the file names (<code>n_phrases</code>). So another input of our function can be <code>n_phrases</code>. We can also imagine that the phrases represent something different (<code>names_phrases</code>). Let us call another input of our function <code>labels</code>.</p>
<p>Lastly, we need to name our function. The function name should reflect its main behavior, and as a verb (since functions <em>do</em> something). If it is hard to identify a main behavior, then it is probably best to split the function into multiple functions. Naming functions appropriately is important for readability.</p>
<p>Let us start by listing the behaviors of our function or functions:</p>
<ol type="1">
<li>Take a file path to a folder and get the names of its csv files</li>
<li>Get a matrix from splitting the phrases in each name</li>
<li>Name the columns and turn the matrix into a tibble</li>
<li>Where each row now represents a file, read its respective data into the tibble</li>
<li>The result is a nested data frame of imported data</li>
</ol>
<p>That is a lot for one name to represent. Hence it is more prudent to separate these behaviors into multiple functions.</p>
<p>Let us start with the behaviors dealing with file names. The first 3 behaviors do so. A good name for the combination of these behaviors is <code>describe_files_as_df()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">describe_files_as_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file_path</span>, <span class="va">n_phrases</span>, <span class="va">labels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">file_names</span> <span class="op">&lt;-</span> <span class="va">file_path</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span>  <span class="va">split_matrix</span> <span class="op">&lt;-</span> <span class="va">file_names</span> <span class="op">|&gt;</span> <span class="fu">str_split_fixed</span><span class="op">(</span><span class="st">"[._]"</span>, <span class="va">n_phrases</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">split_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">labels</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last two behaviors concern reading in nested data. Hence <code>read_csv_file_paths()</code></p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">read_csv_file_paths</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">file_paths</span>, <span class="va">read_csv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now our processing code can look like so:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gapminder_nested</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="op">(</span><span class="st">"data-raw"</span>, <span class="st">"gapminder"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">describe_files_as_df</span><span class="op">(</span>n_phrases <span class="op">=</span> <span class="fl">4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>, <span class="st">"country"</span>, <span class="st">"date"</span>, <span class="st">"file_type"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">read_csv_file_paths</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">other_data_nested</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="op">(</span><span class="st">"data-raw"</span>, <span class="st">"other_data"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">describe_files_as_df</span><span class="op">(</span>n_phrases <span class="op">=</span> <span class="fl">2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>, <span class="st">"country"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">read_csv_file_paths</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Code like this is clear and concise. Each line acts as a single action (even if it is composed of multiple, smaller actions) and communicates that action to the reader.</p>
</section><section id="adding-function-checks" class="level3"><h3 class="anchored" data-anchor-id="adding-function-checks">Adding Function Checks</h3>
<p>Did you notice that <code>n_phrases</code> and the length of <code>labels</code> are the same (and should be)? What if they aren’t? We will get an error. Even the error is clear in this situation, when functions become more complicated, the chance of an incomprehensible error increases. Hence it is best to be explicit about the requirements of any functions we create. We can improve <code>describe_files_as_df()</code> by checking for the above. If the check fails, we alert the user of the exact problem. For the alert, we use the <code>cli</code> package.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">describe_files_as_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file_path</span>, <span class="va">n_phrases</span>, <span class="va">labels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_phrases</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="st">"n_phrases must be the same length as labels."</span>, </span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">file_names</span> <span class="op">&lt;-</span> <span class="va">file_path</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span>  <span class="va">split_matrix</span> <span class="op">&lt;-</span> <span class="va">file_names</span> <span class="op">|&gt;</span> <span class="fu">str_split_fixed</span><span class="op">(</span><span class="st">"[._]"</span>, <span class="va">n_phrases</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">split_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">labels</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The error will then look this:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="st">"n_phrases must be the same length as labels."</span>, </span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error:
! n_phrases must be the same length as labels.</code></pre>
</div>
</div>
<p>We can improve it further with <code>cli</code> tricks:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">describe_files_as_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file_path</span>, <span class="va">n_phrases</span>, <span class="va">labels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_phrases</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"{.var n_phrases} must be the same length as {.var labels}."</span>, </span>
<span>        <span class="st">"x"</span> <span class="op">=</span> <span class="st">"You've supplied {.var n_phrases} as {n_phrases} but {.var labels} has length {length(labels)}."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">file_names</span> <span class="op">&lt;-</span> <span class="va">file_path</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span>  <span class="va">split_matrix</span> <span class="op">&lt;-</span> <span class="va">file_names</span> <span class="op">|&gt;</span> <span class="fu">str_split_fixed</span><span class="op">(</span><span class="st">"[._]"</span>, <span class="va">n_phrases</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">split_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">labels</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">describe_files_as_df</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="op">)</span>, <span class="st">"5"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `describe_files_as_df()`:
! `n_phrases` must be the same length as `labels`.
✖ You've supplied `n_phrases` as 5 but `labels` has length 1.</code></pre>
</div>
</div>
<p>Furthermore, we know <code>file_path</code> should be a single string, <code>n_phrases</code> should be a number and <code>labels</code> should be a vector of strings. R is relaxed about numbers being portrayed as, for example, <code>"5"</code> or <code>5</code>. On the other hand, we can check for the types for <code>file_path</code> and <code>labels</code> using <code>cli</code> again and <code>rlang</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">describe_files_as_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file_path</span>, <span class="va">n_phrases</span>, <span class="va">labels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is_string</span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"{.var file_path} must be a single string."</span>,</span>
<span>        <span class="st">"x"</span> <span class="op">=</span> <span class="st">"You've supplied a {.cls {class(file_path)}} vector with length {length(file_path)}."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"character"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"{.var labels} must be a character vector."</span>,</span>
<span>        <span class="st">"x"</span> <span class="op">=</span> <span class="st">"You've supplied a {.cls {class(labels)}} vector."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_phrases</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"{.var n_phrases} must be the same length as {.var labels}."</span>, </span>
<span>        <span class="st">"x"</span> <span class="op">=</span> <span class="st">"You've supplied {.var n_phrases} as {n_phrases} but {.var labels} has length {length(labels)}."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">file_names</span> <span class="op">&lt;-</span> <span class="va">file_path</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span>  <span class="va">split_matrix</span> <span class="op">&lt;-</span> <span class="va">file_names</span> <span class="op">|&gt;</span> <span class="fu">str_split_fixed</span><span class="op">(</span><span class="st">"[._]"</span>, <span class="va">n_phrases</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">split_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">labels</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">describe_files_as_df</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="op">)</span>, <span class="fu">here</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `describe_files_as_df()`:
! `file_path` must be a single string.
✖ You've supplied a &lt;character&gt; vector with length 2.</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_files_as_df</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `describe_files_as_df()`:
! `labels` must be a character vector.
✖ You've supplied a &lt;numeric&gt; vector.</code></pre>
</div>
</div>
<p>We can apply the same concepts to <code>read_csv_file_paths()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">read_csv_file_paths</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"data.frame"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"{.var df} must be a data frame."</span>,</span>
<span>        <span class="st">"x"</span> <span class="op">=</span> <span class="st">"You've supplied something of class {.cls {class(df)}}."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="st">"file_paths"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli_abort</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"{.var df} must contain a column named {.var file_paths}."</span>,</span>
<span>        <span class="st">"x"</span> <span class="op">=</span> <span class="st">"You've supplied a data frame with columns {.var {colnames(df)}}."</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">file_paths</span>, <span class="va">read_csv</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">read_csv_file_paths</span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `read_csv_file_paths()`:
! `df` must contain a column named `file_paths`.
✖ You've supplied a data frame with columns `Sepal.Length`, `Sepal.Width`,
  `Petal.Length`, `Petal.Width`, and `Species`.</code></pre>
</div>
</div>
</section><section id="comparing-your-functions-to-others" class="level3"><h3 class="anchored" data-anchor-id="comparing-your-functions-to-others">Comparing Your Functions to Others</h3>
<p>When writing functions, it is important to be aware of other, already existing functions and objects.</p>
<p>For example, <code><a href="https://rdrr.io/r/base/labels.html">labels()</a></code> is actually a base R function. If we do not overwrite <code>labels</code>, it prints as:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (object, ...) 
UseMethod("labels")
&lt;bytecode: 0x00000272e6f0d888&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
</div>
<p>In our <code>describe_files_as_df()</code>, we can get different results:</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">describe_files_as_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file_path</span>, <span class="va">n_phrases</span>, <span class="va">labels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">describe_files_as_df</span><span class="op">(</span>labels <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "test"
[1] "1"</code></pre>
</div>
</div>
<p>Here <code>labels</code> is both the string <code>"test"</code> and the function name (the <code>labels</code> part) of <code><a href="https://rdrr.io/r/base/labels.html">labels()</a></code>. There’s no trouble in using both, unless it causes confusion. If you believe something like this will cause confusion, you can rename the <code>labels</code> argument in <code>describe_files_as_df()</code> as <code>labels_vector</code>.</p>
<p>Where we need to be more careful is when a function with the same name as our <em>function</em> already exists. For example, if we were to create our own <code><a href="https://rdrr.io/r/base/labels.html">labels()</a></code> function. Another example would be if <code>describe_files_as_df()</code> was already a function in some library we loaded. R will not, by default, warn or error on these conflicts. In this situation, it’s best to directly refer to the source of the functions coming from packages or from base R:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"test"</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1"</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"an example"</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "an example"</code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/labels.html">labels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<!-- Fortunately, the packaged `conflicted` will. -->
<!-- After loading `conflicted`, -->
<!-- ```{r} -->
<!-- #| error: true -->
<!-- labels <- function(x) {names(x)} -->
<!-- labels("test") -->
<!-- ``` -->


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03-learn-as-you-go.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Learn (As You Go)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-text-data.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Prepare for Text Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">R Beginner’s Guide was written by Adam Sadowski.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>